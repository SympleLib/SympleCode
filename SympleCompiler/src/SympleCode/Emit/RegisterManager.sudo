struct Register:
	int reg
	int/bool spillpos

class RegisterManager:
	private:
		vector [ Register* ] regs
		bool [] freeRegs

	public:
		Register* Alloc():
			maybe ret free register

			ret spill reg
			add reg to regs

		Register* CAlloc():
			Register reg = Alloc()
			xor reg
			ret reg

		void Free(Register*):
			set free to true